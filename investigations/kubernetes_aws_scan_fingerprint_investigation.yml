---
creation_date: "2020-03-24"
data_metadata:
  data_source:
    - "AWS CloudWatch EKS Logs"
  data_sourcetypes:
    - "aws:cloudwatchlogs:eks"
  providing_technologies:
    - AWS
description: "This search provides investigation data of unauthenticated requests via user agent, and authentication data against Kubernetes cluster"
entities:
  - src_user
how_to_implement: "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrailinputs. The threshold value should be tuned to your environment."
id: a636cca4-7434-4a15-a278-c70734938e38
investigate:
  splunk:
    fields_required:
      - src_user
    schedule:
      cron_schedule: "0 * * * *"
      earliest_time: "-70m@m"
      latest_time: "-10m@m"
    search: sourcetype="aws:cloudwatchlogs:eks" "user.username"="system:anonymous"| spath sourceIPs{}=* | search verb=* stage=* userAgent=* requestURI=* annotations.authorization.k8s.io/decision=* |table user.username sourceIPs{} verb stage userAgent requestURI annotations.authorization.k8s.io/decision _time"
maintainers:
  -
    company: Splunk
    email: rsoto@splunk.com
    name: "Rod Soto"
modification_date: "2020-04-13"
name: "Amazon EKS Kubernetes cluster fingerprint scan investigation"
original_authors:
  -
    company: Splunk
    email: rsoto@splunk.com
    name: "Rod Soto"
references: []
security_domain: threat
spec_version: 2
type: splunk
version: "1.0"
