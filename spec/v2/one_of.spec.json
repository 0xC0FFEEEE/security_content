{
  "$id": "https://api.splunkresearch.com/schemas/detections.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "correlation_rule": {
    "properties": {
      "description": "Various fields to enhance usability in Enterprise Security",
      "properties": {
        "notable": {
          "description": "Various fields associated with creating a notable event",
          "properties": {
            "nes_fields": {
              "description": "A list of suggested fields to be used for notable-event suppression",
              "type": "string"
            },
            "rule_description": {
              "description": "Description of the notable event that will display in Incident Review",
              "type": "string"
            },
            "rule_title": {
              "description": "Title of the notable event that will display in Incident Review",
              "type": "string"
            }
          },
          "required": [
            "rule_description",
            "rule_title",
            "nes_fields"
          ],
          "type": "object"
        },
        "risk": {
          "description": "Fields associated with assigning risk to objects",
          "properties": {
            "risk_object": {
              "description": "TThe field to which you are assigning risk",
              "type": "string"
            },
            "risk_object_type": {
              "description": "The type of object to which you are assigning risk",
              "items": {
                "enum": [
                  "system",
                  "user",
                  "other"
                ],
                "type": "string"
              },
              "maxItems": 1,
              "minItems": 0,
              "type": "array",
              "uniqueItems": true
            },
            "risk_score": {
              "description": "Score assigned to risk_object",
              "type": "integer"
            }
          },
          "required": [
            "risk_score",
            "risk_object",
            "risk_object_type"
          ],
          "type": "object"
        },
        "scheduling": {
          "description": "Various fields to assist in scheduling the search",
          "properties": {
            "cron_schedule": {
              "description": "Schedule of the search in cron format",
              "type": "string"
            },
            "earliest_time": {
              "description": "The earliest time the search should run in Splunk format",
              "type": "string"
            },
            "latest_time": {
              "description": "The latest time tes search should run against in Splunk format",
              "type": "string"
            }
          },
          "type": "object"
        },
        "search": {
          "description": "The search that will trigger phantom playbook",
          "type": "string"
        },
        "suppress": {
          "description": "Fields associated with suppressing the creation of multiple alerts",
          "properties": {
            "suppress_fields": {
              "description": "The fields to base the suppression on",
              "type": "string"
            },
            "suppress_period": {
              "description": "The length of time the suppression should be in effect",
              "type": "string"
            }
          },
          "required": [
            "suppress_fields",
            "suppress_period"
          ],
          "type": "object"
        }
      },
      "required": [
        "search",
        "scheduling"
      ],
      "type": "object"
    },
    "type": "object"
  },
  "definitions": {
    "phantom": {
      "properties": {
        "correlation_rule": {
          "$ref": "#/correlation_rule"
        },
        "phantom_server": {
          "description": "IP address and username of the phantom server. Currently, we will ship this value as automation (hostname) and we encourage the users to modify those values according to their environment. Eg: automation (hostname)",
          "type": "string"
        },
        "playbook_name": {
          "description": "Name of the playbook. This name should be the same as the name on phantom community repository on github with underscores and appended with community/<playbook_name>. The playbooks are hosted on https://github.com/phantomcyber/playbooks. Eg: community/simple_network_enrichment",
          "type": "string"
        },
        "playbook_url": {
          "description": "Url of the playbook on Phantom website.",
          "type": "string"
        },
        "sensitivity": {
          "description": "TLP colors (White, Green, Amber or Red)",
          "type": "string"
        },
        "severity": {
          "description": "Severity in phantom (High, Medium, Low)",
          "type": "string"
        }
      },
      "required": [
        "playbook_name",
        "phantom_server",
        "playbook_url"
      ],
      "type": "object"
    },
    "splunk": {
      "properties": {
        "correlation_rule": {
          "$ref": "#/correlation_rule"
        }
      },
      "required": [
        "correlation_rule"
      ],
      "type": "object"
    },
    "uba": {
      "properties": {
        "correlation_rule": {
          "$ref": "#/correlation_rule"
        },
        "event_type": {
          "description": "An anomaly or threat.",
          "type": "string"
        },
        "model": {
          "description": "The name of the Splunk UBA model that detected the anomaly.",
          "type": "string"
        },
        "model_version": {
          "description": "Url of the playbook on Phantom website.",
          "type": "string"
        },
        "threat_category": {
          "description": "The category of a threat in Splunk UBA.",
          "type": "string"
        }
      },
      "required": [
        "correlation_rule",
        "event_type",
        "model",
        "model_version",
        "threat_category"
      ],
      "type": "object"
    }
  },
  "description": "A object that defines the parameters for detecting things using various Splunk capabilities",
  "properties": {
    "detect": {
      "anyOf": [
        {
          "splunk": {
            "$ref": "#/definitions/splunk"
          }
        },
        {
          "phantom": {
            "$ref": "#/definitions/phantom"
          }
        },
        {
          "uba": {
            "$ref": "#/definitions/uba"
          }
        }
      ]
    }
  },
  "required": [
    "detect"
  ],
  "title": "Detection Manifest",
  "type": "object"
}
