name: Suspicious Cloud Authentication Activities
detections:
  - name: AWS Cross Account Activity From Previously Unseen Account
    file: cloud/aws_cross_account_activity_from_previously_unseen_account.yml
    pass_condition: '| stats count | where count > 0'
  - name: Detect AWS Console Login by User from New City
    file: cloud/detect_aws_console_login_by_user_from_new_city.yml
    pass_condition: '| stats count | where count > 0'
  - name: Detect AWS Console Login by User from New Country
    file: cloud/detect_aws_console_login_by_user_from_new_country.yml
    pass_condition: '| stats count | where count > 0'
  - name: Detect AWS Console Login by User from New Region
    file: cloud/detect_aws_console_login_by_user_from_new_region.yml
    pass_condition: '| stats count | where count > 0'
  - name: Detect AWS Console Login by New User
    file: cloud/detect_aws_console_login_by_new_user.yml
    pass_condition: '| stats count | where count > 0'
description: Test Suspicious Cloud Authentication Activities detections
target: N/A
simulation_technique: N/A
attack_data:
  - file_name: cloudtrail_behavioural_detections.json
    data: https://attack-range-attack-data.s3-us-west-2.amazonaws.com/cloudtrail_behavioural_detections/cloudtrail_behavioural_detections.json
    sourcetype: aws:cloudtrail

