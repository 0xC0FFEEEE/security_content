name: AWS Excessive List Command Usage
id: d1767712-9650-11eb-a8e6-acde48001122
version: 1
date: '2021-04-05'
author: Michael Haag, Splunk
type: batch
datamodel:
description: UPDATE_DESCRIPTION
search: '`cloudtrail` command=list* userIdentity.type=IAMUser
| bucket _time span=1h 
| stats count as total min(_time) as firstTime max(_time) as lastTime , dc(command) as list_command, dc(eventSource) as sources values(command) by src_ip, userName, _time
| where total >= 5 and list_command >= 1 and sources >= 1
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
| `aws_excessive_list_command_usage_filter`'
how_to_implement: UPDATE_HOW_TO_IMPLEMENT
known_false_positives: UPDATE_KNOWN_FALSE_POSITIVES
references:
tags:
  analytic_story:
  - UPDATE_STORY_NAME
  dataset:
  - UPDATE_DATASET_URL
  kill_chain_phases:
  - Reconnaissance
  mitre_attack_id:
  - T1003.002
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  - Splunk Security Analytics for AWS
  required_fields:
  - _time
  security_domain: access

