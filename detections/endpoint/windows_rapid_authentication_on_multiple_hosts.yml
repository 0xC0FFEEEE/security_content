name: Windows Rapid Authentication on Multiple Hosts
id: 62606c77-d53d-4182-9371-b02cdbbbcef7
version: 1
date: '2023-03-23'
author: Mauricio Velazco, Splunk
type: TTP
datamodel: []
description: UPDATE_DESCRIPTION
search: ' EventCode=4624 LogonType=3 TargetUserName!="ANONYMOUS LOGON" TargetUserName!="*$"
  | bucket span=5m _time
  | stats dc(Computer) AS unique_targets values(Computer) as host_targets by _time, IpAddress, TargetUserName
  | where unique_targets > 40
  | `windows_rapid_authentication_on_multiple_hosts_filter`'
how_to_implement: To successfully implement this search, you need to be ingesting
  Windows Event Logs from domain controllers as well as member servers and workstations.
  The Advanced Security Audit policy setting `Audit Logon` within `Logon/Logoff` needs
  to be enabled.
known_false_positives: Vulnerability scanners or system administration tools may also trigger this detection. Filter as needed.
references:
- https://attack.mitre.org/techniques/T1135/
tags:
  analytic_story:
  - Active Directory Privilege Escalation
  asset_type: Endpoint
  cis20:
  - CIS 3
  - CIS 5
  - CIS 16
  confidence: 80
  context:
  - Source:Endpoint
  - Stage:Discovery
  - Stage:Privilege Escalation
  dataset:
  - https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1135/rapid_authentication_multiple_hosts/windows-security.log
  impact: 60
  kill_chain_phases:
  - Exploitation
  message: UPDATE message
  mitre_attack_id:
  - T1003.002
  nist:
  - DE.CM
  observable:
  - name: ComputerName
    type: Endpoint
    role:
    - Victim
  - name: IpAddress
    type: Endpoint
    role:
    - Attacker
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  required_fields:
  - _time
  - EventCode
  - Logon_Type
  - TargetUserName
  - Computer
  - IpAddress
  risk_score: 48
  security_domain: endpoint
