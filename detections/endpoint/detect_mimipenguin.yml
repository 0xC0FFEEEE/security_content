name: Detect MimiPenguin
id: 1ad20afa-547b-11ec-b4e7-acde48001122
version: 1
date: '2021-12-03'
author: Rod Soto
type: TTP
datamodel:
- Endpoint
description:
	MimiPenguin is a tool that dumps login passwords from current linux destop users. This search detects execution of this tool.
search: '| source="Syslog:Linux-Sysmon/Operational" CommandLine="strings -e /etc/apache2/apache2.conf" OR CommandLine="strings -e /etc/ssh/sshd_config" OR CommandLine="strings -e /etc/shadow"  | stats count by Computer parent_process process_current_directory user
 | `detect_mimipenguin_filter`'
how_to_implement: This detection search is based on Splunk add-on for Microsoft Sysmon-Linux. Need to install this add-on to parse fields correctly and execute detection search.
known_false_positives: Some of these commands may be executed by sysadmin however not in the proximity and frequency, specially if querying for tools are that knonwn not to be installed at target system.
references:
- https://github.com/huntergregal/mimipenguin
- https://attack.mitre.org/matrices/enterprise/linux/
tags:
  analytic_story:
  - Linux Post Exploitation
  dataset:
  - https://github.com/splunk/attack_data/raw/master/datasets/suspicious_behaviour/linux_post_exploitation/mimipenguin.txt
  kill_chain_phases:
  - Privilege Escalation
  mitre_attack_id:
  - T1552
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  required_fields:
  - _time
  - Computer
  - parent_process
  - process_current_directory
  - user
  security_domain: endpoint
  impact: 50
  confidence: 70
  # (impact * confidence)/100
  risk_score: 60
  context:
      - Source: endpoint
      - Stage: discovery
  message: MimiPenguin post exploitation tool detected
  observable:
      - name: Computer
      - Type: Hostname
      - role: Victim
