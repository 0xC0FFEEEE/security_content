name: Splunk Identified SSL TLS Certificates
id: 620fbb89-86fd-4e2e-925f-738374277586
version: 1
date: '2022-05-25'
author: Michael Haag, Splunk
type: Hunting
datamodel:
- Network_Traffic
description: The following analytic uses tags of SSL, TLS and certificate to identify the usage of the Splunk default certificates being utilized in the environment. Recommended guidance to utilize valid TLS certificates which documentation may be found in Splunk Docs - https://docs.splunk.com/Documentation/Splunk/8.2.6/Security/AboutsecuringyourSplunkconfigurationwithSSL.
search: 'tag IN (ssl, tls, certificate) ssl_issuer_common_name=*splunk* | stats values(src) AS "Host(s) with Default Cert" count by ssl_issuer ssl_subject_common_name ssl_subject_organization ssl_subject host sourcetype
  | `splunk_identified_ssl_tls_certificates_filter`'
how_to_implement: Ingestion of SSL/TLS data is needed and to be tagged properly as ssl, tls or certificate. This data may come from a proxy, zeek, or Splunk Streams.
known_false_positives: False positives will not be present as it is meant to assist with identifying default certificates being utilized.
references:
  - https://docs.splunk.com/Documentation/Splunk/8.2.6/Security/AboutsecuringyourSplunkconfigurationwithSSL
tags:
  analytic_story:
  - Splunk Vulnerabilities
  asset_type: Proxy
  cis20:
  - CIS 3
  - CIS 5
  - CIS 16
  cve:
  - CVE-2022-32151
  - CVE-2022-32152
  confidence: 100
  context:
  - Source:Application Log
  dataset:
  - https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1040/ssltls/ssl_splunk.log
  impact: 100
  kill_chain_phases:
  - Reconnaissance
  message: The following $dest$ is using the self signed Splunk certificate.
  mitre_attack_id:
  - T1040
  nist:
  - DE.CM
  observable:
  - name: dest
    type: Hostname
    role:
    - Victim
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  required_fields:
  - ssl_issuer
  - ssl_subject_common_name
  - ssl_subject_organization
  - ssl_subject
  - host
  - sourcetype
  risk_score: 100
  security_domain: network
