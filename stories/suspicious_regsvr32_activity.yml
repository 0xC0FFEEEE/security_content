name: Suspicious Regsvr32 Activity
id: b8bee41e-624f-11eb-ae93-0242ac130002
version: 1
date: '2021-01-29'
description: Monitor and detect techniques used by attackers who leverage the regsvr32.exe
  process to execute malicious code.
narrative: 'One common adversary tactic is to bypass application control solutions
  via the regsvr32.exe process. This particular bypass was popularized with "SquiblyDoo"
  using the "scrobj.dll" dll to load .sct scriptlets. This technique is still widely used
  by adversaries to bypass detection and prevention controls. 
  The file extension of the DLL is irrelevant (it may load a .txt for example). 
  The searches in this story help you detect and investigate suspicious activity that
  may indicate that an adversary is leveraging regsvr32.exe to execute malicious code.'
author: Michael Haag, Splunk
type: ESCU
references:
- https://attack.mitre.org/techniques/T1218/010/
- https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.010/T1218.010.md
- https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/
tags:
  analytics_story: Suspicious Regsvr32 Activity
  usecase: Advanced Threat Detection
  category:
  - Adversary Tactics