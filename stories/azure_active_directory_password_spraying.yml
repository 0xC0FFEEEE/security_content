name: Azure Active Directory Password Spraying
id: 41514c46-7118-4eab-a9bb-f3bfa4e3bea9
version: 1
date: '2022-07-07'
author: Mauricio Velazco, Splunk
description: Monitor for activities and techniques associated with Password Spraying
  attacks within Azure Active Directory tenants.
narrative: 'In a password spraying attack, adversaries leverage one or a small list
  of commonly used / popular passwords against a large volume of usernames to acquire
  valid account credentials. Unlike a Brute Force attack that targets a specific user
  or small group of users with a large number of passwords, password spraying follows
  the opposite aproach and increases the chances of obtaining valid credentials while
  avoiding account lockouts. This allows adversaries to remain undetected if the target
  organization does not have the proper monitoring and detection controls in place.\

  Password Spraying can be leveraged by adversaries across different stages in an
  attack. It can be used to obtain an iniial access to an environment but can also
  be used to escalate privileges when access has been already achieved. In some scenarios,
  this technique capitalizes on a security policy most organizations implement, password
  rotation. As enterprise users change their passwords, it is possible some pick predictable,
  seasonal passwords such as `$CompanyNameWinter`, `Summer2021`, etc.\

  Specifically, this Analytic Story is focused on detecting possible Password Spraying
  attacks against Azure Active Directory tenants leveraging Azure AD Audit Logs.'
references:
- https://attack.mitre.org/techniques/T1110/003/
- https://docs.microsoft.com/en-us/security/compass/incident-response-playbook-password-spray
- https://www.cisa.gov/uscert/ncas/alerts/aa21-008a
- https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes
tags:
  analytic_story: Azure Active Directory Password Spraying
  category:
  - Adversary Tactics
  - Account Compromise
  - Cloud Security
  - Privilege Escalation
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  usecase: Advanced Threat Detection
