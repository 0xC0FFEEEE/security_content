{
  "baseline": {
    "splunk": {
      "schedule": {
        "earliest_time": "-301@d",
        "latest_time": "-1d@d"
      },
      "search": "| tstats `summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes by Processes.user Processes.dest Processes.process_name Processes.process | search user!=unknown `drop_dm_object_name(\"Processes\")` | `ctime(firstTime)`| `ctime(lastTime)`| eval processlen=len(process) | fit DensityFunction processlen by user into cmdline_pdfmodel"
    }
  },
  "creation_date": "2019-04-29",
  "data_metadata": {
    "data_models": [
      "Endpoint"
    ],
    "data_source": [
      "Endpoint Intel"
    ],
    "providing_technologies": [
      "Carbon Black Response",
      "CrowdStrike Falcon",
      "Sysmon",
      "Tanium",
      "Ziften"
    ]
  },
  "description": "This search is used to build an MLTK model to characterize the length of the command lines observed for each user in the environment. By default, the search uses the last 30 days of data to build the model. The model created by this search is then used in the corresponding detection search, which uses it to identify outliers in the length of the command line.",
  "eli5": "Create a machie learning model to characterize the length of the command lines used in your environment to help identify unusually long ones that can be indicative of attackers executing commands on systems in your environment.",
  "entities": [
    "dest",
    "commandline"
  ],
  "how_to_implement": "To successfully implement this search, you must be ingesting endpoint data and populating the Endpoint data model. In addition, you must have the machine learning toolkit version >= 4.2 installed along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, and ensure the search completes in a reasonable timeframe. You may also want to periodically re-run this search to rebuild the model with the latest data.",
  "id": "d2a4d85b-fc6a-47a0-82f6-bc1ec2ebc459",
  "known_false_positives": "Use \"| summary cmdline_pdfmodel\" to inspect attributes of the model ",
  "maintainers": [
    {
      "company": "Splunk",
      "email": "rvaldez@splunk.com",
      "name": "Rico Valdez"
    }
  ],
  "modification_date": "2019-04-29",
  "name": "Model Builder For \"Unusually Long Command Line - MLTK\"",
  "original_authors": [
    {
      "company": "Splunk",
      "email": "rvaldez@splunk.com",
      "name": "Rico Valdez"
    }
  ],
  "product_type": "splunk",
  "spec_version": 2,
  "version": "1.0"
}
