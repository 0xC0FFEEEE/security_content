name: AWS CloudTrail
id: aa8d90bf-8ab1-4a9f-8c1b-24a67b1cd0b0
version: 1
date: '2024-07-18'
author: Patrick Bareiss, Splunk
source: aws_cloudtrail
sourcetype: aws:cloudtrail
separator: eventName
supported_TA:
- name: Splunk Add-on for Amazon Web Services (AWS)
  url: https://splunkbase.splunk.com/app/1876
  version: 7.4.1
description: Data source object for AWS CloudTrail
event_sources:
- AWS CloudTrail AssumeRoleWithSAML
- AWS CloudTrail ConsoleLogin
- AWS CloudTrail CopyObject
- AWS CloudTrail CreateAccessKey
- AWS CloudTrail CreateKey
- AWS CloudTrail CreateLoginProfile
- AWS CloudTrail CreateNetworkAclEntry
- AWS CloudTrail CreatePolicyVersion
- AWS CloudTrail CreateSnapshot
- AWS CloudTrail CreateTask
- AWS CloudTrail CreateVirtualMFADevice
- AWS CloudTrail DeactivateMFADevice
- AWS CloudTrail DeleteAccountPasswordPolicy
- AWS CloudTrail DeleteAlarms
- AWS CloudTrail DeleteDetector
- AWS CloudTrail DeleteGroup
- AWS CloudTrail DeleteIPSet
- AWS CloudTrail DeleteLogGroup
- AWS CloudTrail DeleteLogStream
- AWS CloudTrail DeleteLoggingConfiguration
- AWS CloudTrail DeleteNetworkAclEntry
- AWS CloudTrail DeletePolicy
- AWS CloudTrail DeleteRule
- AWS CloudTrail DeleteRuleGroup
- AWS CloudTrail DeleteSnapshot
- AWS CloudTrail DeleteTrail
- AWS CloudTrail DeleteVirtualMFADevice
- AWS CloudTrail DeleteWebACL
- AWS CloudTrail DescribeEventAggregates
- AWS CloudTrail DescribeImageScanFindings
- AWS CloudTrail DescribeSnapshotAttribute
- AWS CloudTrail GetAccountPasswordPolicy
- AWS CloudTrail GetObject
- AWS CloudTrail GetPasswordData
- AWS CloudTrail JobCreated
- AWS CloudTrail ModifyDBInstance
- AWS CloudTrail ModifyImageAttribute
- AWS CloudTrail ModifySnapshotAttribute
- AWS CloudTrail PutBucketAcl
- AWS CloudTrail PutBucketLifecycle
- AWS CloudTrail PutBucketReplication
- AWS CloudTrail PutBucketVersioning
- AWS CloudTrail PutImage
- AWS CloudTrail PutKeyPolicy
- AWS CloudTrail ReplaceNetworkAclEntry
- AWS CloudTrail SetDefaultPolicyVersion
- AWS CloudTrail StopLogging
- AWS CloudTrail UpdateAccountPasswordPolicy
- AWS CloudTrail UpdateLoginProfile
- AWS CloudTrail UpdateSAMLProvider
- AWS CloudTrail UpdateTrail
fields:
- _time
- action
- app
- awsRegion
- aws_account_id
- change_type
- command
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- dest
- direction
- dvc
- errorCode
- eventCategory
- eventID
- eventName
- eventSource
- eventTime
- eventType
- eventVersion
- eventtype
- host
- index
- linecount
- managementEvent
- msg
- object
- object_category
- object_id
- product
- protocol
- punct
- readOnly
- recipientAccountId
- region
- requestID
- requestParameters.groupId
- requestParameters.ipPermissions.items{}.fromPort
- requestParameters.ipPermissions.items{}.ipProtocol
- requestParameters.ipPermissions.items{}.ipRanges.items{}.cidrIp
- requestParameters.ipPermissions.items{}.toPort
- responseElements._return
- responseElements.requestId
- responseElements.securityGroupRuleSet.items{}.cidrIpv4
- responseElements.securityGroupRuleSet.items{}.fromPort
- responseElements.securityGroupRuleSet.items{}.groupId
- responseElements.securityGroupRuleSet.items{}.groupOwnerId
- responseElements.securityGroupRuleSet.items{}.ipProtocol
- responseElements.securityGroupRuleSet.items{}.isEgress
- responseElements.securityGroupRuleSet.items{}.securityGroupRuleId
- responseElements.securityGroupRuleSet.items{}.toPort
- signature
- source
- sourceIPAddress
- sourcetype
- splunk_server
- src
- src_ip
- src_ip_range
- src_port_range
- start_time
- status
- tag
- tag::eventtype
- timeendpos
- timestartpos
- tlsDetails.cipherSuite
- tlsDetails.clientProvidedHostHeader
- tlsDetails.tlsVersion
- user
- userAgent
- userIdentity.accessKeyId
- userIdentity.accountId
- userIdentity.arn
- userIdentity.principalId
- userIdentity.type
- userIdentity.userName
- userName
- user_access_key
- user_agent
- user_arn
- user_group_id
- user_id
- user_name
- user_type
- vendor
- vendor_account
- vendor_product
- vendor_region
example_log: '{"eventVersion": "1.09", "userIdentity": {"type": "IAMUser", "principalId":
  "AIDAAAAAAAAAAAAAAAAAA", "arn": "arn:aws:iam::111111111111:user/daftpunk_cli", "accountId":
  "111111111111", "accessKeyId": "AKIAAAAAAAAAAAAAAAAA", "userName": "daftpunk_cli"},
  "eventTime": "2024-02-21T19:19:40Z", "eventSource": "ec2.amazonaws.com", "eventName":
  "AuthorizeSecurityGroupIngress", "awsRegion": "us-west-2", "sourceIPAddress": "2.2.2.2",
  "userAgent": "aws-cli/2.13.22 Python/3.11.5 Darwin/22.5.0 source/arm64 prompt/off
  command/ec2.authorize-security-group-ingress", "requestParameters": {"groupId":
  "sg-07ffb1896dcd3713e", "ipPermissions": {"items": [{"ipProtocol": "-1", "fromPort":
  -1, "toPort": -1, "groups": {}, "ipRanges": {"items": [{"cidrIp": "0.0.0.0/0"}]},
  "ipv6Ranges": {}, "prefixListIds": {}}]}}, "responseElements": {"requestId": "4950930b-2129-423c-95b0-1b87c8fa115a",
  "_return": true, "securityGroupRuleSet": {"items": [{"groupOwnerId": "111111111111",
  "groupId": "sg-07ffb1896dcd3713e", "securityGroupRuleId": "sgr-0217c1b508cc6b76c",
  "isEgress": false, "ipProtocol": "-1", "fromPort": -1, "toPort": -1, "cidrIpv4":
  "0.0.0.0/0"}]}}, "requestID": "4950930b-2129-423c-95b0-1b87c8fa115a", "eventID":
  "bdade96f-6272-468a-b084-413b9711e92f", "readOnly": false, "eventType": "AwsApiCall",
  "managementEvent": true, "recipientAccountId": "111111111111", "eventCategory":
  "Management", "tlsDetails": {"tlsVersion": "TLSv1.3", "cipherSuite": "TLS_AES_128_GCM_SHA256",
  "clientProvidedHostHeader": "ec2.us-west-2.amazonaws.com"}}'
