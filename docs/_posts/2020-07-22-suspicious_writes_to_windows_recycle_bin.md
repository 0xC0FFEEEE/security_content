---
title: "Suspicious writes to windows Recycle Bin"
excerpt: "Masquerading"
categories:
  - Endpoint
last_modified_at: 2020-07-22
toc: true
tags:
  - TTP
  - T1036
  - Masquerading
  - Defense Evasion
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
---

# Suspicious writes to windows Recycle Bin

This search detects writes to the recycle bin by a process other than explorer.exe.

- **Product**: Splunk Enterprise, Splunk Enterprise Security, Splunk Cloud
- **Datamodel**:
- **ATT&CK**: [T1036](https://attack.mitre.org/techniques/T1036/)
- **Last Updated**: 2020-07-22
- **Author**: Rico Valdez, Splunk


#### ATT&CK

| ID          | Technique   | Tactic       |
| ----------- | ----------- |--------------|
| T1036 | Masquerading | Defense Evasion |


#### Search

```

| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.file_path) as file_path values(Filesystem.file_name) as file_name FROM datamodel=Endpoint.Filesystem where Filesystem.file_path = &#34;*$Recycle.Bin*&#34; by Filesystem.process_id Filesystem.dest 
| `drop_dm_object_name(&#34;Filesystem&#34;)`
| search [
| tstats `security_content_summariesonly` values(Processes.user) as user values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name FROM datamodel=Endpoint.Processes where Processes.process_name != &#34;explorer.exe&#34; by Processes.process_id Processes.dest
| `drop_dm_object_name(&#34;Processes&#34;)` 
| table process_id dest] 
| `suspicious_writes_to_windows_recycle_bin_filter`
```

#### Associated Analytic Story

* [Collection and Staging](_stories/collection_and_staging)


#### How To Implement
To successfully implement this search you need to be ingesting information on filesystem and process logs responsible for the changes from your endpoints into the `Endpoint` datamodel in the `Processes` and `Filesystem` nodes.

#### Required field

* _time

* Filesystem.file_path

* Filesystem.file_name

* Filesystem.process_id

* Filesystem.dest

* Processes.user

* Processes.process_name

* Processes.parent_process_name

* Processes.process_id

* Processes.dest


#### Kill Chain Phase


#### Known False Positives
Because the Recycle Bin is a hidden folder in modern versions of Windows, it would be unusual for a process other than explorer.exe to write to it. Incidents should be investigated as appropriate.



#### RBA

| Risk Score  | Impact      | Confidence   |
| ----------- | ----------- |--------------|
| 28.0 | 40 | 70 |



#### Reference


#### Test Dataset
Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)


* [https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036/write_to_recycle_bin/windows-sysmon.log](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036/write_to_recycle_bin/windows-sysmon.log)


_version_: 4

```
#############
# Automatically generated by doc_gen.py in https://github.com/splunk/security_content''
# On Date: 2021-09-17 11:18:22.231580 UTC''
# Author: Splunk Security Research''
# Contact: research@splunk.com''
#############
```