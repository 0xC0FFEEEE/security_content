---
title: "Large Volume of DNS ANY Queries"
excerpt: "Reflection Amplification"
categories:
  - Network
last_modified_at: 2017-09-20
toc: true
tags:
  - Anomaly
  - T1498.002
  - Reflection Amplification
  - Impact
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  - Network_Resolution
  - Actions on Objectives
---

# Large Volume of DNS ANY Queries

The search is used to identify attempts to use your DNS Infrastructure for DDoS purposes via a DNS amplification attack leveraging ANY queries.

- **Product**: Splunk Enterprise, Splunk Enterprise Security, Splunk Cloud
- **Datamodel**:[Network_Resolution](https://docs.splunk.com/Documentation/CIM/latest/User/NetworkResolution)
- **ATT&CK**: [T1498.002](https://attack.mitre.org/techniques/T1498/002/)
- **Last Updated**: 2017-09-20
- **Author**: Bhavin Patel, Splunk


#### ATT&CK

| ID          | Technique   | Tactic       |
| ----------- | ----------- |--------------|
| T1498.002 | Reflection Amplification | Impact |


#### Search

```

| tstats `security_content_summariesonly` count from datamodel=Network_Resolution where nodename=DNS &#34;DNS.message_type&#34;=&#34;QUERY&#34; &#34;DNS.record_type&#34;=&#34;ANY&#34; by &#34;DNS.dest&#34; 
| `drop_dm_object_name(&#34;DNS&#34;)` 
| where count&gt;200 
| `large_volume_of_dns_any_queries_filter`
```

#### Associated Analytic Story

* [DNS Amplification Attacks](_stories/dns_amplification_attacks)


#### How To Implement
To successfully implement this search you must ensure that DNS data is populating the Network_Resolution data model.

#### Required field

* _time

* DNS.message_type

* DNS.record_type

* DNS.dest


#### Kill Chain Phase

* Actions on Objectives


#### Known False Positives
Legitimate ANY requests may trigger this search, however it is unusual to see a large volume of them under typical circumstances. You may modify the threshold in the search to better suit your environment.




#### Reference


#### Test Dataset
Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)



_version_: 1

```
#############
# Automatically generated by doc_gen.py in https://github.com/splunk/security_content''
# On Date: 2021-09-17 11:18:22.100937 UTC''
# Author: Splunk Security Research''
# Contact: research@splunk.com''
#############
```