---
title: "Attacker Tools On Endpoint"
excerpt: "Match Legitimate Name or Location, Active Scanning, OS Credential Dumping"
categories:
  - Endpoint
last_modified_at: 2021-06-21
toc: true
tags:
  - TTP
  - T1036.005
  - Match Legitimate Name or Location
  - Defense Evasion
  - T1595
  - Active Scanning
  - Reconnaissance
  - T1003
  - OS Credential Dumping
  - Credential Access
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  - Endpoint
  - Installation
  - Command and Control
  - Actions on Objectives
---

# Attacker Tools On Endpoint

This search looks for execution of commonly used attacker tools on an endpoint.

- **Product**: Splunk Enterprise, Splunk Enterprise Security, Splunk Cloud
- **Datamodel**:[Endpoint](https://docs.splunk.com/Documentation/CIM/latest/User/Endpoint)
- **ATT&CK**: [T1036.005](https://attack.mitre.org/techniques/T1036/005/), [T1595](https://attack.mitre.org/techniques/T1595/), [T1003](https://attack.mitre.org/techniques/T1003/)
- **Last Updated**: 2021-06-21
- **Author**: Bhavin Patel, Splunk


#### ATT&CK

| ID          | Technique   | Tactic       |
| ----------- | ----------- |--------------|
| T1036.005 | Match Legitimate Name or Location | Defense Evasion |
| T1595 | Active Scanning | Reconnaissance |
| T1003 | OS Credential Dumping | Credential Access |


#### Search

```

| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process) as process values(Processes.parent_process) as parent_process from datamodel=Endpoint.Processes where Processes.dest!=unknown Processes.user!=unknown by Processes.dest Processes.user Processes.process_name Processes.process 
| `security_content_ctime(firstTime)` 
| `security_content_ctime(lastTime)` 
| `drop_dm_object_name(Processes)` 
| lookup attacker_tools attacker_tool_names AS process_name OUTPUT description 
| search description=* 
| `attacker_tools_on_endpoint_filter`
```

#### Associated Analytic Story

* [Monitor for Unauthorized Software](_stories/monitor_for_unauthorized_software)

* [XMRig](_stories/xmrig)

* [SamSam Ransomware](_stories/samsam_ransomware)

* [Unusual Processes](_stories/unusual_processes)


#### How To Implement
To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. This is typically populated via endpoint detection-and-response product, such as Carbon Black or endpoint data sources, such as Sysmon. The data used for this search is usually generated via logs that report process tracking in your Windows audit settings.

#### Required field

* Processes.dest

* Processes.user

* Processes.process_name

* Processes.parent_process


#### Kill Chain Phase

* Installation

* Command and Control

* Actions on Objectives


#### Known False Positives
Some administrator activity can be potentially triggered, please add those users to the filter macro.



#### RBA

| Risk Score  | Impact      | Confidence   |
| ----------- | ----------- |--------------|
| 64.0 | 80 | 80 |



#### Reference


#### Test Dataset
Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)


* [https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1595/attacker_scan_tools/windows-sysmon.log](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1595/attacker_scan_tools/windows-sysmon.log)


_version_: 1

```
#############
# Automatically generated by doc_gen.py in https://github.com/splunk/security_content''
# On Date: 2021-09-17 11:18:21.942098 UTC''
# Author: Splunk Security Research''
# Contact: research@splunk.com''
#############
```